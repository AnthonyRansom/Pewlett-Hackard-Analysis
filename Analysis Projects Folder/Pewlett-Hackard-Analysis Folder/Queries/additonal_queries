SELECT DISTINCT ON (u.emp_no) u.emp_no,
	u.first_name,
	u.last_name,
	d.dept_no,
	dept.dept_name
	INTO retirement_departments
FROM unique_titles AS u
	INNER JOIN dept_emp AS d
	ON (u.emp_no = d.emp_no)
	INNER JOIN departments AS dept
	ON (d.dept_no = dept.dept_no)
ORDER BY u.emp_no;

SELECT COUNT(emp_no), dept_name
INTO retiring_Departments
FROM retirement_departments
GROUP BY dept_name
ORDER BY count DESC;



select count(emp_no) as qty, date_part('year',birth_date) as year
from employees
WHERE birth_date >= '1952-01-01' AND birth_date <= '1955-12-31'
group by date_part('year',birth_date)
order by year;